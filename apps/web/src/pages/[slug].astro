---
import MarketingLayout from '../layouts/MarketingLayout.astro'
import { cmsClient } from '../lib/cms'
import PageContent from '../components/PageContent.astro'
import SEO from '../components/SEO.astro'

export const prerender = true

export async function getStaticPaths() {
  const pages = await cmsClient.getPages()
  
  return pages.map((page) => ({
    params: { slug: page.slug },
    props: { 
      title: page.title,
      hero: page.hero,
      layout: page.layout,
      meta: page.meta,
      updatedAt: page.updatedAt,
      createdAt: page.createdAt
    },
  }))
}

const { title, hero, layout, meta } = Astro.props
---

<MarketingLayout>
  <Fragment slot="head">
    <SEO
      title={meta?.title || title}
      description={meta?.description}
      image={meta?.image}
    />
  </Fragment>

  <PageContent title={title} hero={hero} layout={layout} meta={meta} />
</MarketingLayout>