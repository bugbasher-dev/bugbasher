---
import MarketingLayout from '../layouts/MarketingLayout.astro'
import { cmsClient } from '../lib/cms'
import PageContent from '../components/PageContent.astro'
export const prerender = true;
const { title, hero, layout, meta } = Astro.props

export async function getStaticPaths() {
  const pages = await cmsClient.getPages()
  
  return pages
    .map((page) => {
      return {
        params: { slug: page.slug },
        props: { 
          title: page.title,
          hero: page.hero,
          layout: page.layout,
          meta: page.meta,
          updatedAt: page.updatedAt,
          createdAt: page.createdAt
        },
      }
    })
}
---

<MarketingLayout>
  {/* SEO Meta Tags */}
  <Fragment slot="head">
    <title>{meta?.title || title || 'Page'}</title>
    {meta?.description && <meta name="description" content={meta.description} />}
    {meta?.image && typeof meta.image === 'object' && meta.image.url && (
      <>
        <meta property="og:image" content={meta.image.url} />
        <meta name="twitter:image" content={meta.image.url} />
      </>
    )}
  </Fragment>

  <PageContent title={title} hero={hero} layout={layout} meta={meta} />
</MarketingLayout>